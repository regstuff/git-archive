<html><head>
   <title>git-archive 404</title>
   <link rel="stylesheet" href="/git-archive/style.css">
</head><body>

<div style="font-size:large; text-align: center; margin: 40px 20px 20px 40px;">This page does not exist. Did you come here to archive an URL? If so, check the browser console and the response below.</h3>
<hr>
    
<div id="responseText"></div>
<script> 
    var url = "https://api.github.com/repos/regstuff/git-archive/issues";
    var xhr = new XMLHttpRequest();
    xhr.open("POST", url);

    console.log('window.location.host', window.location.host)
    console.log('window.location.href', window.location.href)
    var token = 'token ' + window.location.pathname.split('/')[2]
    console.log('token', token)
    var title = decodeURIComponent(window.location.href.split('?archiveurl=')[1])
    console.log('title', title)
    
    
    xhr.setRequestHeader("Accept", "application/vnd.github.v3+json");
    xhr.setRequestHeader("Authorization", token);
    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    
    xhr.onreadystatechange = function () {
       if (xhr.readyState === 4) {
          console.log(xhr.status);
          console.log(xhr.responseText);
          if (xhr.status == 201) {document.getElementById('responseText').innerHTML = `<h2>Archiving Success!</h2><p>${xhr.responseText}</p>`}
          else {document.getElementById('responseText').innerHTML = `<h2>Failure!!! Status ${xhr.status}</h2><p>${xhr.responseText}</p>`}
          
       }};
    
    var data = `{"title":"${title}"}`;
    console.log('data',data)
    if (title != '') {xhr.send(data);}
    

</script>



</body></html>
